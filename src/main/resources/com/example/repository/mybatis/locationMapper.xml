<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.example.repository.mybatis.locationMapper">
    <select id="selectListCount" resultType="_int">
        SELECT COUNT(*)
        FROM LOCATION
        WHERE USER_NO = #{userNo}
    </select>

    <insert id="insertCoordinate" parameterType="location">
        INSERT INTO LOCATION(
            LOCATION_NO,
            USER_NO,
            LOCATION_LATITUDE,
            LOCATION_LONGITUDE,
            LOCATION_DATE
        )
        VALUES (
                       (select *from (select max(LOCATION_NO)+1 from LOCATION) next),
                   #{userNo},
                   #{locationLatitude},
                   #{locationLongitude},
                   NOW()
               )
    </insert>

    <update id="updateCoordinate" parameterType="location">
        UPDATE LOCATION
        SET LOCATION_LATITUDE = #{locationLatitude},
            LOCATION_LONGITUDE = #{locationLongitude}
        WHERE USER_NO = #{userNo}
    </update>


    <resultMap type="location" id="loResultSet">
        <result column="LOCATION_LATITUDE" property="locationLatitude"/>
        <result column="LOCATION_LONGITUDE" property="locationLongitude"/>
    </resultMap>

    <select id="selectMapList" resultMap="loResultSet">
        SELECT LOCATION_LATITUDE,
               LOCATION_LONGITUDE
        FROM LOCATION
    </select>
</mapper>